---
layout: post
title: "flashrom and Shuttle AV18E2"
date: 2012-01-06T14:31:00+01:00
categories:
 - coreboot
---

<div class='post'>
<span style="font-family: 'Courier New', Courier, monospace;">During Christmas break I found an old unused motherboard in my home, right away I thought that it maybe useful as learning environment for coreboot. First you need to do with this kind of board is to check if it is possible to flash its BIOS with user space tool called <a href="http://www.flashrom.org/">flashrom</a>&nbsp;list of supported hardware can be found <a href="http://www.flashrom.org/Supported_hardware">here</a>.</span><br />
<span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br />
<span style="font-family: 'Courier New', Courier, monospace;">All you need to do is go through <a href="http://www.flashrom.org/Board_Testing_HOWTO">this HOWTO</a>.&nbsp;Be aware that these operations can cause you will not be able to run your motherboard if something goes wrong. Therefore, I suggest protect yourself by supplying checked programmer or other memory chip for your board containing a working BIOS.</span><br />
<span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br />
<span style="font-family: 'Courier New', Courier, monospace;">For my <a href="http://www.shuttle.eu/_archive/older/de/av18.htm">Shuttle board</a>&nbsp;I checked if the Winbond&nbsp;W49F002U&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">chip on it is supported by flashrom. Fortunately it was. After that I read my BIOS by:</span><br />
<pre class="brush:bash;gutter:false">flashrom -Vr bios_bckp.bin</pre>
<pre><span style="font-family: 'Courier New', Courier, monospace;">And write it by:</span></pre>
<div>
<pre class="brush:bash;gutter:false">flashrom -Vw bios_bckp.bin</pre>
<span style="font-family: 'Courier New', Courier, monospace;">At the end I've got</span>&nbsp;<span style="font-family: 'Courier New', Courier, monospace;">VERIFIED message but when I look&nbsp;carefully&nbsp;inside the log there was something like this:</span>
<br />
<pre class="brush:plain;gutter:false">Erasing and writing flash chip... Trying erase function 0... 0x000000-0x01ffff:S,
 0x020000-0x037fff:S, 0x038000-0x039fff:S, 0x03a000-0x03bfff:S, 0x03c000-0x03ffff:S
Erase/write done.
Verifying flash... VERIFIED.</pre>
<span style="font-family: 'Courier New', Courier, monospace;">This means that these addresses have not been overwritten but skipped, becuse the fact that the data which were to be overridden were identical with what we wanted to write.&nbsp;So if we found such output to properly verify flashrom we need to clear our memory and write it again with BIOS backup. Correct output should look like this:</span><br />
<pre class="brush:plain;gutter:false">Erasing and writing flash chip... Trying erase function 0... 0x000000-0x01ffff:W,
0x020000-0x037fff:W, 0x038000-0x039fff:W, 0x03a000-0x03bfff:W, 0x03c000-0x03ffff:W
Erase/write done.
Verifying flash... VERIFIED. 
</pre>
<span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br />
<span style="font-family: 'Courier New', Courier, monospace;">Next post I will try to&nbsp;familiarize you with the process of debugging coreboot using <a href="http://wiki.qemu.org/Main_Page">QEMU</a>.</span></div></div>
